Script Name: [Maclen] Money Flow Strategy
Author: MaclenMtz
Description: This is a strategy based on a smoothed overbought and oversold indicator of money flow. 

It was design on BTCUSDT Perpetual Futures of Binance with a timeframe of 1D. 

Feel free to comment and publish any idea to improve this strategy.
PineScript code:

Pine Scriptâ„¢ strategy
[Maclen] Money Flow Strategy
Copy code
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
//@version=4
//ForÂ BinanceÂ BTCUSDTÂ FuturesÂ timeframeÂ 1D
palancaÂ =Â input(defvalÂ =Â 5,Â titleÂ =Â "Leverage")
porc_capÂ =Â input(defvalÂ =Â 80,Â titleÂ =Â "%Â CapitalÂ forÂ Operation")/100
strategy("MoneyÂ FlowÂ Strategy",Â shorttitle="MoneyFlow",Â overlay=false,Â slippage=5,initial_capital=100,currency=currency.USD,Â default_qty_type=strategy.fixed,Â default_qty_value=0.1,Â pyramiding=0,Â commission_type=strategy.commission.percent,Â 
Â Â Â Â Â commission_value=0.08)
//----------------------------BacktestÂ window-----------------------------
//InputÂ BacktestingÂ Range
fromMonthÂ =Â input(defvalÂ =Â 1,Â Â Â Â titleÂ =Â "FromÂ Month"Â Â Â Â Â Â ,Â minvalÂ =Â 1,Â maxvalÂ =Â 12)
fromDayÂ Â Â =Â input(defvalÂ =Â 1,Â Â Â Â titleÂ =Â "FromÂ Day"Â Â Â Â Â Â Â Â ,Â minvalÂ =Â 1,Â maxvalÂ =Â 31)
fromYearÂ Â =Â input(defvalÂ =Â 2020,Â titleÂ =Â "FromÂ Year"Â Â Â Â Â Â Â ,Â minvalÂ =Â 1970)
thruMonthÂ =Â input(defvalÂ =Â 1,Â Â Â Â titleÂ =Â "ThruÂ Month"Â Â Â Â Â Â ,Â minvalÂ =Â 1,Â maxvalÂ =Â 12)
thruDayÂ Â Â =Â input(defvalÂ =Â 1,Â Â Â Â titleÂ =Â "ThruÂ Day"Â Â Â Â Â Â Â Â ,Â minvalÂ =Â 1,Â maxvalÂ =Â 31)
thruYearÂ Â =Â input(defvalÂ =Â 2021,Â titleÂ =Â "ThruÂ Year"Â Â Â Â Â Â Â ,Â minvalÂ =Â 1970)
//FuntionÂ 
startÂ Â Â Â Â =Â timestamp(fromYear,Â fromMonth,Â fromDay,Â 00,Â 00)Â Â Â Â Â Â Â Â //Â backtestÂ startÂ window
finishÂ Â Â Â =Â timestamp(thruYear,Â thruMonth,Â thruDay,Â 23,Â 59)Â Â Â Â Â Â Â Â //Â backtestÂ finishÂ window
window()Â Â =>Â timeÂ >=Â startÂ andÂ timeÂ <=Â finishÂ ?Â trueÂ :Â falseÂ Â Â Â Â Â Â //Â createÂ functionÂ "withinÂ windowÂ ofÂ time"
//______________________________Logica____________________________________________
lengthÂ =Â input(title="Length",Â type=input.integer,Â defval=40,Â minval=1,Â maxval=2000)
srcÂ =Â hlc3
upperÂ =Â sum(volumeÂ *Â (change(src)Â <=Â 0Â ?Â 0Â :Â src),Â length)
lowerÂ =Â sum(volumeÂ *Â (change(src)Â >=Â 0Â ?Â 0Â :Â src),Â length)
mfÂ =Â rsi(upper,Â lower)
smoothÂ =Â input(30,Â "SmoothÂ Period")
mf_SÂ =Â ema(mf,Â smooth)
plot(mf_S,Â "MF_S",Â color=#459915)
sobrecompraÂ =Â input(defval=61,Â title="Overbought")
sobreventaÂ =Â input(defval=42,Â title="Oversold")
overbought=hline(sobrecompra,Â title="Overbought",Â color=#c0c0c0)
oversold=hline(sobreventa,Â title="Oversold",Â color=#c0c0c0)
fill(overbought,Â oversold,Â color=#9915ff,Â transp=90,Â title="Background")
lLongÂ =Â input(59,Â "limit_exitLong")
lShortÂ =Â input(44,Â "limit_exitShort")
Cierre1=hline(lLong,Â title="c_Long",Â color=#c0c0c0)
Cierre2=hline(lShort,Â title="c_Short",Â color=#c0c0c0)
fill(Cierre1,Â Cierre2,Â color=#D500FF,Â transp=90,Â title="Background")
//----------------Long/Short----------------------
longÂ =Â crossunder(mf_S,Â sobreventa)
shortÂ =Â crossover(mf_S,Â sobrecompra)
cLongÂ =Â mfÂ [1]Â >Â lLongÂ andÂ mfÂ >Â lLong
cShortÂ =Â mfÂ [1]Â <Â lShortÂ andÂ mfÂ <Â lShort
//-------------Operation-------------------------
contratoÂ =Â ((strategy.equity)*palanca*porc_cap)/close
strategy.entry("BUY",Â strategy.long,Â qty=contrato,Â whenÂ =Â longÂ andÂ window())
strategy.entry("SELL",Â strategy.short,Â qty=contrato,Â whenÂ =Â shortÂ andÂ window())
clÂ =Â input(false,Â Â Â Â Â Â Â "CloseÂ withÂ LimitÂ ofÂ OBÂ oÂ OSÂ ğŸ’¹")
if(Â clÂ ==Â true)
Â Â Â Â strategy.close("BUY",Â whenÂ =Â cLong)
Â Â Â Â strategy.close("SELL",Â whenÂ =Â cShort)
//Â -------Â TrailingÂ andÂ SL-----------
sl_inpÂ =Â input(12.0,Â title='StopÂ LossÂ %')/100
tp_inpÂ =Â input(25.0,Â title='TakeÂ ProfitÂ %')/100
toffÂ =Â input(2,Â title="trailÂ offset")/100
sl_buyÂ =Â strategy.position_avg_price/(1Â +Â sl_inp)
trail_buyÂ =Â strategy.position_avg_price*(1Â +Â tp_inp)
trail_offset_buy=Â (strategy.position_avg_price-Â (strategy.position_avg_price/(1Â +Â toff)))/syminfo.mintick
sl_sellÂ =Â strategy.position_avg_price*(1Â +Â sl_inp)
trail_sellÂ =Â strategy.position_avg_price/(1Â +Â tp_inp)
trail_offset_sell=Â ((strategy.position_avg_price*(1Â +Â toff))-strategy.position_avg_price)/syminfo.mintick
ttsÂ =Â input(true,Â Â Â Â Â Â Â "TTPÂ andÂ SLÂ ğŸ’¹")
if(ttsÂ ==Â true)
Â Â Â Â strategy.exit("exitBuy","BUY",Â trail_price=Â trail_buy,Â trail_offsetÂ =Â trail_offset_buy,Â stop=Â sl_buy)
Â Â Â Â strategy.exit("exitSell","SELL",Â trail_price=Â trail_sell,Â trail_offsetÂ =Â trail_offset_sell,Â stop=Â sl_sell)
Expand (98 lines)